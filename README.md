# Wide-swath satellite altimetry unveils global submesoscale ocean dynamics

This package contains the code associated with the paper "Wide-swath satellite altimetry unveils global submesoscale ocean dynamics," submitted to Nature.

Matlab2023b was utilized to generate the main figures for this study. No specialized software was required for the analyses presented. The code for each figure is included in the package, labeled as Figure?.m, where ? ranges from 1 to 4.

The following includes pseudo-code descriptions. The description was generated by AI based on the actual code, and verfied by the authors.

## Figure1.m: Plot Figure 1

This script generates the first figure for the paper, utilizing data from the SWOT (Surface Water and Ocean Topography) mission and AVISO (Archiving, Validation, and Interpretation of Satellite Oceanographic data) to visualize sea surface height (SSH) variations in the Mascarene region.

1. Initialization:
   - The script begins by clearing any existing variables and the command window.

2. Time Specification:
   - A specific date (`May 8, 2023`) is defined for the analysis.

3. Load SWOT Data:
   - The script loads the SWOT Level 2 data specific to the Mascarene region from the file `swot_L2_Mascarene.mat`.

4. AVISO Data Retrieval:
   - It constructs a file name to match the AVISO dataset based on the specified date.
   - The script then searches for the appropriate AVISO file in the specified directory.

5. Data Processing:
   - After loading the AVISO data, the script extracts SSH values for the specified longitude and latitude ranges (58° to 67° E and -20° to -5° N).
   - A detrending operation is applied to the SSH data to remove linear trends.

6. Figure Generation:
   - A new figure is created to plot the detrended SSH data.
   - The plot uses `pcolor` to visualize the SSH variations with a specified colormap.
   - Contours of bathymetric data are added to indicate depth levels.
   - Additional SSH data from the SWOT mission is overlaid on the main plot.

7. Zoomed In View:
   - The script adjusts the axes to focus on a specific region within the Mascarene area, updating the limits and color axis to enhance visualization.

### Visualization Settings:
- Transparency: The SSH plot is set with a transparency of 0.75 for better overlay visibility.
- Colormap: A flipped red-blue colormap is applied for clear differentiation of SSH values.
- Aspect Ratio: The aspect ratio of the plot is adjusted for accurate geographic representation.


## Figure2.m: Plot Figure 2

This script generates the second figure for the paper, visualizing the standard deviation of SSH differences between various binned data sets derived from the SWOT mission and AVISO comparisons in the Karin region.

1. Initialization:
   - The script begins by clearing the workspace and command window.

2. Load Coastline Data:
   - It loads default Matlab coastline data for geographical context.

3. Data Directory Setup:
   - A directory path is specified where the binned AVISO data files are located. All `.mat` files in this directory are listed for processing.

4. Loading and Storing Data:
   - A loop iterates over each `.mat` file:
     - Each file is loaded, and the variable `karinbin` is extracted and saved into a new variable named `diffbin{i}` (where `i` is the index of the file).
     - Temporary variables are cleared to manage memory.

5. Standard Deviation Calculation:
   - A nested loop iterates through the grid indices:
     - For each grid cell, the standard deviation of the SSH differences is calculated by aggregating data from all loaded `diffbin` variables.
     - The computed standard deviation is stored in the `data` matrix.

6. Figure Generation:
   - A new figure is created using the Robinson projection to display global data.
   - The standard deviation data is visualized using `m_pcolor`, with a color shading applied.
   - A color axis is set to range from 0 to 0.1, and a deep ocean colormap is applied.

7. Geographical Features:
   - Contour lines of bathymetric data are added using `m_etopo2`, with a light gray edge color.
   - The coastline is overlaid in a patch with a specified gray color.

8. Grid and Formatting:
   - A grid is added to the figure, with specific formatting for the axes, including font size and weight.
   - The figure background is set to white, and a colorbar is added at the bottom of the figure for reference.


## Figure3.m: Plot Figure 3 Panels

1. SWOT Data Loading:
   - The script loads the SWOT data from the specified file and sets the time for analysis.

2. AVISO Data Processing:
   - It reads AVISO data from a NetCDF file and extracts SSH data for a defined geographic region based on specified longitude and latitude bounds.

3. Main Figure Plotting:
   - A Lambert projection is used to visualize the extracted AVISO SSH data, applying a colormap and adding coastline and grid features.

4. Interpolation:
   - AVISO SSH data is interpolated onto the SWOT swath using a gridded interpolant to align both datasets.

5. 1D Profile Plotting:
   - For specified indices, SSH values from both SWOT and interpolated AVISO data are plotted as a function of distance across an eddy, with distinct color schemes for each dataset.

6. 2D SSH Plots:
   - Separate figures are generated to display 2D SSH fields for both the SWOT and interpolated AVISO data, with contour overlays for additional clarity.

7. Velocity Calculation:
   - The script computes geostrophic velocities based on SSH gradients, applying smoothing to the velocity fields before visualizing the magnitude and direction with a quiver plot.

8. Vorticity Calculation:
   - Vorticity is computed from the geostrophic velocities, and the resulting field is visualized in a separate figure.

9. SST Data Loading and Plotting:
   - Sea surface temperature (SST) data is loaded from a specified file, and a new figure is created to display the SST across the defined region using a Miller projection.

## Figure4.m: Plot Figure 4. Unsmoothed Data with Better QC

1. Data Loading:
   - The script loads unsmoothed SWOT data for the Andaman region from a specified `.mat` file and also loads coastline data for geographical context.

2. Time Averaging:
   - It computes the average time for each cycle of data, allowing for a quick overview of the temporal range covered by the dataset.

3. Data Quality Control (QC):
   - For each pass in the dataset, the script applies quality control by filtering out values in `dataL` (left-hand) and `dataR` (right-hand) that exceed specified thresholds (±n).

4. Plotting:
   - For each time cycle, a figure is generated:
     - The coastline is plotted in black.
     - SSH data for both left and right passes is visualized using `pcolor`, with median detrending applied to normalize the data.
     - The axes are adjusted for aspect ratio and limits, and a color map is applied.

5. Adding AVISO Data:
   - AVISO data is read from a NetCDF file and plotted in a new figure. The coastline is again overlaid to provide context.

6. Robinson Projection Plot:
   - A separate figure utilizes the Robinson projection to display the AVISO SSH data, with coastlines and grid features included for clarity.
